var $elm=null;var $elmbet=null;var gm_book=[];function fillBetTable(jsonResponseString){if(typeof jsonResponseString.Table!='undefined'){$(jsonResponseString.Table).each(function(i,value){var Back3=(value.Back3!=0)?value.Back3:'0';var Back2=(value.Back2!=0)?value.Back2:'0';var Back1=(value.Back1!=0)?value.Back1:'0';var Backsize3=(value.Backsize3!=0)?value.Backsize3:'0';var Backsize2=(value.Backsize2!=0)?value.Backsize2:'0';var Backsize1=(value.Backsize1!=0)?value.Backsize1:'0';var Lay3=(value.Lay3!=0)?value.Lay3:'0';var Lay2=(value.Lay2!=0)?value.Lay2:'0';var Lay1=(value.Lay1!=0)?value.Lay1:'0';var Laysize3=(value.Laysize3!=0)?value.Laysize3:'0';var Laysize2=(value.Laysize2!=0)?value.Laysize2:'0';var Laysize1=(value.Laysize1!=0)?value.Laysize1:'0';$(".bck-frst-"+i).html(Back3+'<span>'+Backsize3+'</span>');$(".bck-scnd-"+i).html(Back2+'<span>'+Backsize2+'</span>');$(".bck-all-"+i).html(Back1+'<span>'+Backsize1+'</span>');$(".lay-all-"+i).html(Lay1+'<span>'+Laysize1+'</span>');$(".lay-scnd-"+i).html(Lay2+'<span>'+Laysize2+'</span>');$(".lay-last-"+i).html(Lay3+'<span>'+Laysize3+'</span>');});}
var dyn_tbl="";if(typeof jsonResponseString.Table1!='undefined'){if(jsonResponseString.Table1.length>0)
{if(typeof jsonResponseString.Table1!='undefined'){if(jsonResponseString.Table1.length>0)
{$("#daba_lbl").show();}
dyn_tbl+="<table id=\"gamedata\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"bottom-br\">";dyn_tbl+="<thead>";dyn_tbl+="<tr>";dyn_tbl+="<th width=\"11%\">Runners<\/th>";dyn_tbl+="<th width=\"11%\" class=\"Pink-bk\"><\/th>";dyn_tbl+="<th width=\"11%\" class=\"Pink-bk\"><\/th>";dyn_tbl+="<th width=\"11%\" class=\"Pink-bk\">Back<\/th>";dyn_tbl+="<th width=\"11%\" class=\"blue-bk\">Lay<\/th>";dyn_tbl+="<th width=\"11%\" class=\"blue-bk\"><\/th>";dyn_tbl+="<th width=\"11%\" class=\"blue-bk\"><\/th>";dyn_tbl+="<th width=\"11%\">Profit and loss<\/th>";dyn_tbl+="<th width=\"11%\">Client P \/L <\/th>";dyn_tbl+="<\/tr>";dyn_tbl+="<\/thead>";dyn_tbl+="<tbody>";var avg=[0,0];try{if(typeof jsonResponseString.Table1!='undefined')
{avg[0]=(gm_book[jsonResponseString.Table1[0].Sectionid]/gm_book[jsonResponseString.Table1[1].Sectionid]).toFixed(2);avg[1]=(gm_book[jsonResponseString.Table1[1].Sectionid]/gm_book[jsonResponseString.Table1[0].Sectionid]).toFixed(2);avg[0]=Math.abs((isNaN(avg[0])&&isFinite(avg[0]))?'':avg[0])+"%";avg[1]=Math.abs((isNaN(avg[1])&&isFinite(avg[1]))?'':avg[1])+"%";}}catch(e){console.log(e);}
if(typeof jsonResponseString.Table1!='undefined'){$(jsonResponseString.Table1).each(function(i,v){var book=(typeof gm_book[v.Sectionid]!='undefined')?gm_book[v.Sectionid]:"";var color=(book<0)?'style="color:red"':'style="color:green"';var avg1=(typeof avg[i]!='undefined'&&!isNaN(avg[i]))?avg[i]:'';dyn_tbl+="<tr class=\"sectionids\" align=\"right\">";dyn_tbl+="<td align=\"left\">"+v.Nation+"<\/td>";dyn_tbl+="<td class=\"bck-frst\">0<span>0<\/span><\/td>";dyn_tbl+="<td class=\"bck-scnd\">0<span>0<\/span><\/td>";dyn_tbl+="<td class=\"Pink-bk bck-all-0\">"+v.Back1+"<span>"+v.Backsize1+"<\/span><\/td>";dyn_tbl+="<td class=\"blue-bk lay-all-0\">"+v.Lay1+"<span>"+v.Laysize1+"<\/span><\/td>";dyn_tbl+="<td class=\"lay-scnd\">0<span>0<\/span><\/td>";dyn_tbl+="<td class=\"lay-last\">0<span>0<\/span><\/td>";dyn_tbl+="<td class=\"profit\" "+color+">"+book+"<\/td>";dyn_tbl+="<td class=\"client\">"+avg1+"<\/td>";dyn_tbl+="<\/tr>";});}
else
{$("#daba_lbl").hide();}
dyn_tbl+="<\/tbody>";dyn_tbl+="<\/table>";}}
else
{$("#daba_lbl").hide();}}
$("#dyn_tbl").html(dyn_tbl);}
var temp=0;var secarr=[];function ploatgamehtml(response){var jsonString=JSON.stringify(response);if((response.length!=secarr.length&&secarr.length>0)||temp==0)
{secarr=[];ploatgameFullhtml(response);}
else
{ploatgameHalfhtml(response);}}
function ploatgameFullhtml(response){temp=1;var jsonString=JSON.stringify(response);var fancy='';var player_wise='';var meter='';var nCount=0;$.each($.parseJSON(jsonString),function(key,data){if(data.Srno<=10){fancy+=betDataFullHtml(data,nCount);}else if(data.Srno>10&&data.Srno<=20){player_wise+=betDataFullHtml(data,nCount);}else if(data.Srno>20&&data.Srno<=30){meter+=betDataFullHtml(data,nCount);}
secarr.push(data.Sectionid);nCount++;});if(fancy){$('.fancy ul').parent().parent().addClass("left-match-data");$('.fancy ul').html(fancy);}
if(player_wise){$('.player-wise').addClass("match-bet-dtl");$('.player-wise ul').html(player_wise);}
if(meter){$('.meter').addClass("match-bet-dtl");$('.meter ul').html(meter);}}
function ploatgameHalfhtml(response){var jsonString=JSON.stringify(response);var nCount=0;$.each($.parseJSON(jsonString),function(key,data){$('#sectionid-'+nCount).val(data.Sectionid);$('#gametype-'+nCount).val(data.Gametype);$('#updatetime-'+nCount).val(data.updatetime);$('#nation-title-'+nCount).html(data.Nation);$('#back-title-'+nCount).html('<label>'+data.Back1+'</label><span id="back-size-'+nCount+'">'+data.Backsize1+'</span>');$('#lay-title-'+nCount).html('<label>'+data.Lay1+'</label><span id="lay-size-'+nCount+'">'+data.Laysize1+'</span>');$('#min-val-'+nCount).html(data.Minbet);$('#max-val-'+nCount).html(data.Maxbet);if(jQuery.inArray(data.Sectionid,secarr)===-1||response.length!=secarr.length)
{nofound=1;temp=0;}
nCount++;});}
function betDataFullHtml(value,count){var betData='';var marketId=$(".fancyList").data('market-id');betData=betData.concat('<li class="Sec-'+value.Sectionid+'" id="bet-row-'+count+'">');betData=betData.concat('<input type="hidden" class="sectionid-'+count+'"  name="Sectionid" value="'+value.Sectionid+'">');betData=betData.concat('<input id="gametype-'+count+'" type="hidden" name="Gametype" value="'+value.Gametype+'">');betData=betData.concat('<input id="updatetime-'+count+'" type="hidden" name="updatetime" value="'+value.updatetime+'">');betData=betData.concat('<div class="mt-team-nm">');betData=betData.concat('<h2><span id="nation-title-'+count+'" class="nation">'+value.Nation+'</span><span class="client">0.00</span></h2>');betData=betData.concat('<button class="book-btn" onclick="openFancyBook(\''+marketId+'\','+value.Sectionid+')">Book</button>');betData=betData.concat('</div>');betData=betData.concat('<div class="mt-team-bt">');betData=betData.concat('<div class="mt-lay">');betData=betData.concat('<button data-bl="lay" data-row-id="'+count+'" class="mtback-btn" onclick="loadGameDataBetPopup($(this),1)" class="mtlay-btn">');betData=betData.concat('<h3 id="lay-title-'+count+'"><label>'+value.Lay1+'</label><span id="lay-size-'+count+'">'+value.Laysize1+'</span></h3>');betData=betData.concat('</button>');betData=betData.concat('</div>');betData=betData.concat('<div class="mt-back">');betData=betData.concat('<button data-bl="back" data-row-id="'+count+'" class="mtback-btn" onclick="loadGameDataBetPopup($(this),0)">');betData=betData.concat('<h3 id="back-title-'+count+'"><label>'+value.Back1+'</label><span id="back-size-'+count+'">'+value.Backsize1+'</span></h3>');betData=betData.concat('</button>');betData=betData.concat('</div>');betData=betData.concat('<div class="mt-val">');betData=betData.concat('<label>Min:<span id="min-val-'+count+'">'+value.Minbet+'</span></label>');betData=betData.concat('<label>Max:<span id="max-val-'+count+'"> '+value.Maxbet+'</span></label>');betData=betData.concat('</div>');betData=betData.concat('</div>');betData=betData.concat('</div>');betData=betData.concat('</li>');return betData;}
function SetValueMasterbook(response){if(typeof JSON.stringify(response)=='undefined'||response==0){return;}
var userObj=JSON.stringify(response);var userTableObj=(JSON.parse(userObj)).t1;var userTable1Obj=(JSON.parse(userObj)).t2;var userTable2Obj=(JSON.parse(userObj)).t3;var userTable3Obj=(JSON.parse(userObj)).t4;var userTable4Obj=(JSON.parse(userObj)).t5;var userTable5Obj=(JSON.parse(userObj)).t6;var userTable6Obj=(JSON.parse(userObj)).t7;bookmakerSectionVal=userTable1Obj;bookmaker1SectionVal=userTable1Obj;fancySectionVal=userTable2Obj;gameSectionVal=userTable1Obj;$(userTable5Obj).each(function(i,value){gm_book[value.sectionId]=value.book;});$(userTable1Obj).each(function(i,value){gm_book[value.sectionId]=value.amount;});var avg=['',''];if(typeof userTable1Obj!='undefined'&&userTable1Obj){avg[0]=Math.abs((userTable1Obj[0].amount/userTable1Obj[1].amount).toFixed(2))+"%";avg[1]=Math.abs((userTable1Obj[1].amount/userTable1Obj[0].amount).toFixed(2))+"%";}
var j=0;$(userTable1Obj).each(function(i,value){if(value.amount<0){$(".Sec-"+value.sectionId+" .profit").css('color','red');}
else
{$(".Sec-"+value.sectionId+" .profit").css('color','green');}
$(".Sec-"+value.sectionId+" .profit").html(value.amount);if(j<2)
{var newavg=(isNaN(avg[j]))?"0":avg[j];if(typeof newavg!='undefined'){$(".Sec-"+value.sectionId+" .client").html(newavg);}}
j++;});$(userTable2Obj).each(function(i,value){$(".Sec-"+value.sectionId+" .client").html(value.book);});var matchedData='';var matchrecordCount=0;if(userTable3Obj!=undefined&&userTable3Obj.length>0){if(userTable3Obj.length>0)
{$("#matchedCount").html('('+userTable3Obj[0].countval+')');}else{$("#matchedCount").html('('+matchrecordCount+')');}
$(userTable3Obj).each(function(i,value){matchedData=matchedData.concat('<tr class="'+value.betType.toLowerCase()+'">');matchedData=matchedData.concat('<td>'+value.userName+'</td>');matchedData=matchedData.concat('<td>'+value.nation+'</td>');matchedData=matchedData.concat('<td>'+value.userRate+'</td>');matchedData=matchedData.concat('<td class="text-right">'+value.amount+'</td>');matchedData=matchedData.concat('<td>'+value.placeDate+'</td>');matchedData=matchedData.concat('<td>'+value.matchDate+'</td>');matchedData=matchedData.concat('<td>'+value.marketType+'</td>');matchedData=matchedData.concat('</tr>');matchrecordCount++;});}
$("#matched tbody").html(matchedData);var unmatchedData='';var unmatchrecordCount=0;if(userTable4Obj===undefined){return;}
if(userTable4Obj!=undefined&&userTable4Obj.length>0)
{$("#unmatchedCount").html('('+userTable4Obj[0].countval+')');}else{$("#unmatchedCount").html('('+unmatchrecordCount+')');}
$(userTable4Obj).each(function(i,value){unmatchedData=unmatchedData.concat('<tr class="'+value.betType.toLowerCase()+'">');unmatchedData=unmatchedData.concat('<td>'+value.userName+'</td>');unmatchedData=unmatchedData.concat('<td>'+value.nation+'</td>');unmatchedData=unmatchedData.concat('<td>'+value.userRate+'</td>');unmatchedData=unmatchedData.concat('<td>'+value.amount+'</td>');unmatchedData=unmatchedData.concat('<td>'+value.placeDate+'</td>');unmatchedData=unmatchedData.concat('<td>'+value.marketType+'</td>');unmatchedData=unmatchedData.concat('</tr>');unmatchrecordCount++;});$("#unmatched tbody").html(unmatchedData);}
function SetValueNewFancyBook(response){if(typeof JSON.stringify(response)=='undefined'||response==0){return;}
var userObj=JSON.stringify(response);var userTableObj=(JSON.parse(userObj)).Table;var userTable1Obj=(JSON.parse(userObj)).Table1;var newGameResData=[];$.each(userTableObj,function(key,data){if($(".new-analitic-game-data #tr-"+data.SectionId).length>0){newGameResData.push($.trim(data.SectionId));$(".new-analitic-game-data #tr-"+data.SectionId+" td.nation").html(data.Nation);$(".new-analitic-game-data #tr-"+data.SectionId+" td.total-amount").html(data.TotalAmount);$(".new-analitic-game-data #tr-"+data.SectionId+" td.total-bet").html(data.TotalBet);}else{newGameResData.push($.trim(data.SectionId));var tblData='<tr id="tr-'+data.SectionId+'" class="new-analitic-game-tr tr-'+data.SectionId+'" data-section="'+data.SectionId+'" data-marketid="'+data.MarketId+'">';tblData=tblData.concat('<td class="nation">'+data.Nation+'</td>');tblData=tblData.concat('<td class="total-amount">'+data.TotalAmount+'</td>');tblData=tblData.concat('<td class="total-bet">'+data.TotalBet+'</td>');tblData=tblData.concat('<td><button class="book-btn openCreateCasinoBooks" onClick="openCreateCasinoBooks('+data.SectionId+','+data.MarketId+');">Book</button></td>');$(".new-analitic-game-data .tbl-header").after(tblData);}});$(".new-analitic-game-data .new-analitic-game-tr").each(function(){var currentSectionId=$(this).data('section');if($.inArray($.trim(currentSectionId),newGameResData)==-1){$(".new-analitic-game-data #tr-"+currentSectionId).remove();newGameResData=$.grep(newGameResData,function(value){return value!=currentSectionId;});}});var matchedData='';var matchrecordCount=0;$(userTable1Obj).each(function(i,value){matchedData=matchedData.concat('<tr class="'+value.Bettype+'">');matchedData=matchedData.concat('<td>'+value.UserName+'</td>');matchedData=matchedData.concat('<td>'+value.Nation+'</td>');matchedData=matchedData.concat('<td>'+value.Userrate+'</td>');matchedData=matchedData.concat('<td>'+value.amount+'</td>');matchedData=matchedData.concat('<td>'+value.placedate+'</td>');matchedData=matchedData.concat('<td>'+value.matchdate+'</td>');matchedData=matchedData.concat('<td>'+value.markettype+'</td>');matchedData=matchedData.concat('</tr>');matchrecordCount++;});$("#matchedCount").html('('+matchrecordCount+')');$("#matched tbody").html(matchedData);}
function openCreateCasinoBooks(sectionId,marketId){$.ajax({url:"createCasinoBooks.php",type:"get",priority:0,data:{'marketid':marketId,'sectionid':sectionId},success:function(data){$(".fancyBookModal .book-pop").html(data);$("#fancyBookModal .modal-header").removeClass("none");$('#fancyBookModal').reveal({animation:'fadeAndPop',animationspeed:300,closeonbackgroundclick:true,dismissmodalclass:'close-reveal-modal'});}});}